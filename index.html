<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>webex-contact-center-widget-starter</title>

    <link
      href="https://ciscodevnet.github.io/webex-contact-center-widget-starter/css/momentum-ui.min.css"
      type="text/css"
      rel="stylesheet"
    />
    <link
      href="https://ciscodevnet.github.io/webex-contact-center-widget-starter/css/momentum-ui-icons.min.css"
      type="text/css"
      rel="stylesheet"
    />

    <script>
      let AGENTX_SERVICE = {};
    </script>
  </head>
  <body style="width: 99vw; overflow-x: hidden">
    <md-theme lumos>
      <div>
        <header
          style="
            display: flex;
            align-items: center;
            height: 35px;
            padding: 12px;
            background-color: var(--md-primary-bg-color);
            color: var(--md-primary-text-color);
            border-bottom: 1px solid var(--md-primary-seperator-color);
            width: 100%;
          "
        >
          <img src="./webex_cc_logo.png" style="padding-right: 12px" />
          <span style="font-size: 16px; font-weight: bold; padding-right: 12px"
            >Demo Widgets</span
          >
          <md-alert-banner style="flex: 1" show type="warning" closable>
            Some of the demo widgets cannot be previewed, because it needs
            additional props like google api key etc.
          </md-alert-banner>
          <md-toggle-switch click="handleThemeToggle" style="padding: 0 12px"
            >Dark Mode</md-toggle-switch
          >
        </header>
        <main
          style="padding: 12px; background-color: var(--md-secondary-bg-color)"
        >
          <demo-widget-preview></demo-widget-preview>
        </main>
      </div>
    </md-theme>
    <script src="https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/covid-by-location.js"></script>
    <script src="https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/timer.js"></script>
    <script src="https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/rss-feed-widget.js"></script>
    <script src="https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/crm.js"></script>
    <script src="https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/hospital-bed-capacity.js"></script>
    <script src="https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/map-widget.js"></script>
    <script src="https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/learning-widget-sample.js"></script>

    <script>
      const widgets = [
        {
          label: "CRM",
          comp: `<crm-widget phone-number="+1 (800) 471-2389"></crm-widget>`,
          script:
            "https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/crm.js",
          layoutConfig: {
            comp: "crm-widget",
            attributes: { "phone-number": "+1 (800) 471-2389" },
            script:
              "https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/crm.js",
          },
          style: "grid-column: span 3",
        },

        {
          label: "Timer",
          comp: `<timer-widget duration="08:00:00" style="margin-top: 10px"></timer-widget>`,
          script:
            "https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/timer.js",
          layoutConfig: {
            comp: "timer-widget",
            attributes: {
              duration: "08:00:00",
            },
            script:
              "https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/timer.js",
          },
          style: "grid-column: span 1;",
        },
        {
          label: "RSS",
          comp: `<rss-feed-widget rss-feed="https://www.who.int/feeds/entity/csr/don/en/rss.xml"
                update-delay="5000"></rss-feed-widget>`,
          script:
            "https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/rss-feed-widget.js",
          layoutConfig: {
            comp: "rss-feed-widget",
            attributes: {
              "rss-feed": "https://w1.weather.gov/xml/current_obs/PHNL.rss",
            },
            script:
              "https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/rss-feed-widget.js",
          },
          style: "grid-column: span 1;",
        },
        {
          label: "Map",
          comp: `<map-widget api-key="" search-enabled></map-widget>`,
          script:
            "https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/map-widget.js",
          layoutConfig: {
            comp: "map-widget",
            attributes: {
              "api-key": "google api key here",
              "search-enabled": true,
            },
            script:
              "https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/map-widget.js",
          },
          style: "grid-column: span 2;",
          externalProps:
            '<div style="display:grid; grid-template-columns: 1fr auto; gap: 4px"><md-input id="google-api-key-map" placeholder="Please enter Google api key"></md-input> <md-button id="map-widget-btn">Apply</md-button> </div>',
          handler: `document.querySelector('#map-widget-btn').addEventListener('click', () => {
              const gkey = document.querySelector('#google-api-key-map').value;
             
              //console.log('covid-api-key', val);
              document.querySelector('map-widget').setAttribute('api-key', gkey);

            });`,
        },
        {
          label: "Covid By Location",
          comp:
            '<covid-by-location api-key="1318b408f01c4aa3b5f79dedc6c90848" selectedCountyState="New York County, NY"></covid-by-location>',
          script:
            "https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/covid-by-location.js",
          style: "grid-column: span 3;",
          layoutConfig: {
            comp: "covid-by-location",
            script:
              "https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/covid-by-location.js",
            attributes: {
              "api-key": "1318b408f01c4aa3b5f79dedc6c90848",
              selectedCountyState: "New York County, NY",
            },
            wrapper: {
              title: "Covid by location",
              maximizeAreaName: "app-maximize-area",
            },
          },
        },

        {
          label: "Hospital Bed Capacity",
          comp: `<hospital-bed-capacity google-api-key="googleApiKey" covid-api-key="1318b408f01c4aa3b5f79dedc6c90848"
              latitude="88.363892" longitude="-74.005974">`,
          script:
            "https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/hospital-bed-capacity.js",
          layoutConfig: {
            comp: "hospital-bed-capacity",
            attributes: {
              "google-api-key": "googleApiKey",
              "covid-api-key": "covidApiKey",
              latitude: "88.363892",
              longitude: "-74.005974",
            },
            script:
              "https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/hospital-bed-capacity.js",
          },
          style: "grid-column: span 5;",
          externalProps: `<div style="display:grid; grid-template-columns: repeat(4, 1fr) auto; gap: 4px">
              <md-input id="google-api-key" placeholder="google-api-key"></md-input>
              <md-input id="covid-api-key" value="1318b408f01c4aa3b5f79dedc6c90848"  placeholder="covid-api-key"></md-input>
              <md-input value="88.363892" id="latitude" placeholder="latitude"></md-input>
              <md-input value="-74.005974"  id="longitude"  placeholder="longitude"></md-input>
              <md-button id="hospital-bed-capacity-btn">Apply</md-button>
            </div>`,
          handler: `document.querySelector('#hospital-bed-capacity-btn').addEventListener('click', () => {
              const gkey = document.querySelector('#google-api-key').value;
              const ckey = document.querySelector('#covid-api-key').value;
              const lad = document.querySelector('#latitude').value;
              const lon = document.querySelector('#longitude').value;
              //console.log('covid-api-key', val);
              document.querySelector('hospital-bed-capacity').setAttribute('google-api-key', gkey);
              document.querySelector('hospital-bed-capacity').setAttribute('covid-api-key', ckey)
              document.querySelector('hospital-bed-capacity').setAttribute('latitude', lat)
              document.querySelector('hospital-bed-capacity').setAttribute('longitude', lon)

            });`,
        },
        {
          label: "Learning Sample",
          comp: `<learning-sample></learning-sample>`,
          script:
            "https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/learning-widget-sample.js",
          layoutConfig: {
            comp: "learning-sample",
            script:
              "https://ciscodevnet.github.io/webex-contact-center-widget-starter/widgets/learning-widget-sample.js",
          },
          style: "grid-column: span 5;",
        },
      ];
      class DemoWidgetPreview extends HTMLElement {
        connectedCallback() {
          let comps = "";
          widgets.forEach((w) => {
            comps += `
           
                  <div style="${w.style}">
                    <div class="widget-card">
                      <div class="widget-card-container">
                        <div style="display:grid; grid-template-columns: auto 1fr auto; gap:12px ">
                          <b style="flex:1;">${w.label}</b>
                          <span>${w.externalProps ? w.externalProps : ""}</span>

                          <div>
                          <md-menu-overlay
                          size="large"
                          placement="left-start"
                          custom-width="700px"
                          isOpen="false">
                            <md-button outline slot="menu-trigger" variant="white" style="display:flex; justify-content: center;"">Code</md-button>
                            <div style="width: 100%;height: 400px;overflow: auto;display: flex;flex-direction: column;  background-color: var(--md-primary-bg-color); white-space: break-spaces;color: var(--md-primary-text-color);">
                              <div style="    display: flex; flex-direction: column; padding:15px;color: var(--md-primary-text-color);">
                                <span style="background-color: #78F5B7;border-radius: 4px;padding: 8px 16px;font-size: 14px;font-weight: bold;color: var(--md-primary-text-color);">${
                                  w.label
                                }</span>
                                <strong>Layout Config Example</strong>
                                <pre style="color: var(--md-primary-text-color); border: 1px dashed var(--md-primary-seperator-color); padding: 5px; overflow: auto;">${
                                  w.layoutConfig
                                    ? JSON.stringify(w.layoutConfig, null, 4)
                                    : ""
                                }
                                </pre>

                                <a style="margin-top: 12px; padding:12px;background-color:var(--md-secondary-bg-color);  " href="${
                                  w.script
                                }" target="_blank">${w.script}</a>
                              </div>
                            </div>
                          </md-menu-overlay>
                          </div>
                        </div>
                      </div>

                        ${w.comp}
                    </div>

                  </div>
                 
            `;
            setTimeout(() => {
              w.handler ? eval(w.handler) : "";
            }, 1000);
          });
          this.innerHTML = ` <style>
            .widget-card {
              box-shadow: 0 4px 4px 0 var(--md-primary-seperator-color);
              transition: 0.3s;
              background-color: var(--md-primary-bg-color);
              color: var(--md-primary-text-color);
              width: 100%;
            }

            .widget-card:hover {
              box-shadow: 0 8px 8px 0 var(--md-primary-text-color);
            }

            .widget-card-container {
              border-bottom: 1px solid var(--md-primary-seperator-color);
              background-color: var(--md-primary-bg-color);
              color: var(--md-primary-text-color);
              padding: 12px;
            }

            .grid-container {
              display: grid;
              grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
              grid-gap: 12px 12px;
              background-color: var(--md-secondary-bg-color);
              color: var(--md-primary-text-color);
            }

            .widget-card-container + * {
              padding: 12px;
            }
          </style>
          <div class="grid-container">
              ${comps}
          </div>`;
        }
      }

      customElements.define("demo-widget-preview", DemoWidgetPreview);

      document
        .querySelector("md-toggle-switch")
        .addEventListener("click", (e) => {
          const themeElm = document.querySelector("md-theme");
          console.log("e.target.checked", e.target.checked);
          if (e.target.checked) {
            themeElm.setAttribute("darkTheme", true);
          } else {
            themeElm.removeAttribute("darkTheme");
          }
        });
    </script>
  </body>
</html>
